generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
  runtime  = "bun"
}

datasource db {
  provider = "cockroachdb"
}

// Tables

model User {
  id       String @id @default(uuid())
  name     String
  username String @unique
  email    String @unique

  password String
  salt     String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  headline   String?
  about      String?
  locationId String?
  location   Location? @relation(fields: [locationId], references: [id])

  jobApplication      JobApplication[]
  organizationMembers OrganizationMembers[]
  experiences         Experience[]
  education           Education[]
}

model Organization {
  id          String           @id @default(uuid())
  name        String
  slug        String           @unique
  type        OrganizationType @default(COMPANY)
  website     String?
  description String?
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  industry    Industry
  size        OrganizationSize
  tagline     String?

  locationId String?
  location   Location? @relation(fields: [locationId], references: [id])

  jobs                Job[]
  organizationMembers OrganizationMembers[]
  experiences         Experience[]
  education           Education[]

  @@index([type])
}

model OrganizationMembers {
  id             String     @id @default(uuid())
  organizationId String
  userId         String
  role           MemberRole @default(MEMBER)
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt

  organization Organization @relation(fields: [organizationId], references: [id])
  user         User         @relation(fields: [userId], references: [id])
}

model Job {
  id             String         @id @default(uuid())
  title          String
  description    String
  workMode       WorkMode       @default(ONSITE)
  employmentType EmploymentType @default(FULL_TIME)
  organizationId String
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  locationId     String?

  location        Location?        @relation(fields: [locationId], references: [id])
  organization    Organization     @relation(fields: [organizationId], references: [id])
  jobApplications JobApplication[]
}

model JobApplication {
  id        String               @id @default(uuid())
  userId    String
  jobId     String
  status    JobApplicationStatus @default(PENDING)
  createdAt DateTime             @default(now())
  updatedAt DateTime             @updatedAt

  user User @relation(fields: [userId], references: [id])
  job  Job  @relation(fields: [jobId], references: [id])

  @@unique([userId, jobId])
}

model Location {
  id          String   @id @default(uuid())
  latitude    Float?
  longitude   Float?
  city        String
  region      String
  country     String
  countryCode String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  users         User[]
  jobs          Job[]
  organizations Organization[]
  experiences   Experience[]
}

model Experience {
  id                 String         @id @default(uuid())
  title              String
  organizationName   String?
  isCurrentlyWorking Boolean        @default(false)
  startDate          DateTime
  endDate            DateTime?
  description        String?
  employmentType     EmploymentType
  locationType       WorkMode

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userId         String
  locationId     String?
  organizationId String?

  user         User          @relation(fields: [userId], references: [id])
  location     Location?     @relation(fields: [locationId], references: [id])
  organization Organization? @relation(fields: [organizationId], references: [id])
}

model Education {
  id               String    @id @default(uuid())
  organizationName String?
  degree           String?
  fieldOfStudy     String?
  startDate        DateTime
  endDate          DateTime?
  grade            String?
  activities       String?
  description      String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userId         String
  organizationId String?

  user         User          @relation(fields: [userId], references: [id])
  organization Organization? @relation(fields: [organizationId], references: [id])
}

// Enums

enum WorkMode {
  REMOTE
  ONSITE
  HYBRID
}

enum EmploymentType {
  FULL_TIME
  PART_TIME
  CONTRACT
  TEMPORARY
  VOLUNTEER
  INTERNSHIP
}

enum JobApplicationStatus {
  PENDING
  REVIEWED
  ACCEPTED
  REJECTED
}

enum MemberRole {
  SUPER_ADMIN
  ADMIN
  MEMBER
}

enum OrganizationType {
  COMPANY
  SCHOOL
}

enum Industry {
  ACCOUNTING
  ADVERTISING
  AGRICULTURE
  AIRLINES_AVIATION
  APPAREL_FASHION
  ARCHITECTURE_PLANNING
  AUTOMOTIVE
  BANKING
  BIOTECHNOLOGY
  BROADCAST_MEDIA
  CHEMICALS
  CIVIL_ENGINEERING
  COMPUTER_HARDWARE
  COMPUTER_SOFTWARE
  CONSTRUCTION
  CONSULTING
  CONSUMER_ELECTRONICS
  CONSUMER_GOODS
  EDUCATION
  ELECTRICAL_ELECTRONIC_MANUFACTURING
  ENERGY
  ENTERTAINMENT
  ENVIRONMENTAL_SERVICES
  FINANCIAL_SERVICES
  FOOD_BEVERAGES
  GOVERNMENT_ADMINISTRATION
  HEALTHCARE
  HOSPITALITY
  HUMAN_RESOURCES
  INDUSTRIAL_AUTOMATION
  INFORMATION_SERVICES
  INFORMATION_TECHNOLOGY
  INSURANCE
  INTERNET
  INVESTMENT_BANKING
  LAW_PRACTICE
  LEGAL_SERVICES
  LOGISTICS_SUPPLY_CHAIN
  MANUFACTURING
  MARKETING
  MEDIA
  MEDICAL_DEVICES
  MINING_METALS
  NONPROFIT
  OIL_ENERGY
  PHARMACEUTICALS
  PUBLIC_RELATIONS
  REAL_ESTATE
  RESEARCH
  RESTAURANTS
  RETAIL
  SPORTS
  TELECOMMUNICATIONS
  TRANSPORTATION
  UTILITIES
  VENTURE_CAPITAL
  WHOLESALE
}

enum OrganizationSize {
  SELF_EMPLOYED
  ONE_TO_TEN
  ELEVEN_TO_FIFTY
  FIFTY_ONE_TO_TWO_HUNDRED
  TWO_HUNDRED_ONE_TO_FIVE_HUNDRED
  FIVE_HUNDRED_ONE_TO_ONE_THOUSAND
  ONE_THOUSAND_ONE_TO_FIVE_THOUSAND
  FIVE_THOUSAND_ONE_TO_TEN_THOUSAND
  TEN_THOUSAND_PLUS
}
